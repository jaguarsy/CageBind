/* LogWeb v0.1.0 */
!function($){"use strict";var _map=function(a,b){var c=[];if(!a)return c;a.length||(a=[].concat(a));for(var d=0;d<a.length;d++){var e=a[d];c.push(b(e,d)||e)}return c},_createMap=function(){return Object.create(null)},_isDefined=function(a){return"undefined"!=typeof a},_isString=function(a){return"string"==typeof a},_lowercase=function(a){return _isString(a)?a.toLowerCase():a},OPERATORS=_createMap();_map("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(a){OPERATORS[a]=!0});var ESCAPE={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},Lexer=function(){};Lexer.prototype={constructor:Lexer,lex:function(a){for(this.text=a,this.index=0,this.tokens=[];this.index<this.text.length;){var b=this.text.charAt(this.index);if("'"===b||"'"===b)this.readString(b);else if(this.isNumber(b)||"."===b&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(b))this.readIdent();else if(this.is(b,"(){}[].,;:?"))this.tokens.push({index:this.index,text:b}),this.index++;else if(this.isWhitespace(b))this.index++;else{var c=b+this.peek(),d=c+this.peek(2),e=OPERATORS[b],f=OPERATORS[c],g=OPERATORS[d];if(e||f||g){var h=g?d:f?c:b;this.tokens.push({index:this.index,text:h,operator:!0}),this.index+=h.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(a,b){return-1!==b.indexOf(a)},peek:function(a){var b=a||1;return this.index+b<this.text.length?this.text.charAt(this.index+b):!1},isNumber:function(a){return a>="0"&&"9">=a&&"string"==typeof a},isWhitespace:function(a){return" "===a||"\r"===a||"	"===a||"\n"===a||""===a||"Â "===a},isIdent:function(a){return a>="a"&&"z">=a||a>="A"&&"Z">=a||"_"===a||"$"===a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,b,c){c=c||this.index;var d=_isDefined(b)?"s "+b+"-"+this.index+" ["+this.text.substring(b,c)+"]":" "+c;throw"Lexer Error: "+a+" at column"+d+" in expression ["+this.text+"]."},readNumber:function(){for(var a="",b=this.index;this.index<this.text.length;){var c=_lowercase(this.text.charAt(this.index));if("."==c||this.isNumber(c))a+=c;else{var d=this.peek();if("e"==c&&this.isExpOperator(d))a+=c;else if(this.isExpOperator(c)&&d&&this.isNumber(d)&&"e"==a.charAt(a.length-1))a+=c;else{if(!this.isExpOperator(c)||d&&this.isNumber(d)||"e"!=a.charAt(a.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:b,text:a,constant:!0,value:Number(a)})},readIdent:function(){for(var a=this.index;this.index<this.text.length;){var b=this.text.charAt(this.index);if(!this.isIdent(b)&&!this.isNumber(b))break;this.index++}this.tokens.push({index:a,text:this.text.slice(a,this.index),identifier:!0})},readString:function(a){var b=this.index;this.index++;for(var c="",d=a,e=!1;this.index<this.text.length;){var f=this.text.charAt(this.index);if(d+=f,e){if("u"===f){var g=this.text.substring(this.index+1,this.index+5);g.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+g+"]"),this.index+=4,c+=String.fromCharCode(parseInt(g,16))}else{var h=ESCAPE[f];c+=h||f}e=!1}else if("\\"===f)e=!0;else{if(f===a)return this.index++,void this.tokens.push({index:b,text:d,constant:!0,value:c});c+=f}this.index++}this.throwError("Unterminated quote",b)}},$.fn.extend({bindData:function(data){var that=this,cgFuncEnum,isNull=function(a){return null===a||void 0===a},setval=function(a,b){if(a.is("input")||a.is("select"))if(a.is("[type=checkbox]"))a.prop("checked",b);else if(a.is("[type=radio]")){var c=b?b.toString():void 0;a.prop("checked",c==a.val())}else a.val(b),a.trigger("change");else a.is("img")&&b?a.attr("src",b):a.html(b)},_lexer=new Lexer,getval=function(context,expression){if(expression){var tokens=_lexer.lex(expression),contextStr="context.",result=_map(tokens,function(a,b){return context&&a.identifier&&(0===b||tokens[b-1].operator||"["===tokens[b-1].text)?contextStr+a.text:a.text});try{var val=eval(result.join(""));return void 0===val?null:val}catch(e){return console.warn(e),null}}};cgFuncEnum={"cg-show":function(a){var b=a.attr("cg-show");b&&(getval(data,b)?a.show():a.hide())},"cg-class":function(a){var b=a.attr("cg-class");b&&(b=b.replace("{","").replace("}",""),b.split(",").forEach(function(b){var c=b&&b.split(":");c&&getval(data,c[1].trim())&&a.addClass(c[0].trim())}))},"cg-value":function(a){var b=a.attr("cg-value");a.val(getval(data,b))},"cg-list":function(a){var b=a.attr("cg-list"),c=a.attr("cg-list-tpl"),d=getval(data,b);c&&d&&d.length?a.cgbind({templateId:"#"+c,data:d}):a.empty()},"cg-disabled":function(a){var b=getval(data,a.attr("cg-disabled"));a.prop("disabled",b)}};var replaceAttr=function(a,b){a=$(a);for(var c,d,e=a[0]?a[0].attributes:[],f=/\{\{([^\}]+)\}\}/g,g=a.html(),h=0,i=e.length;i>h;h++){var j=e[h].value,k=e[h].name;cgFuncEnum[k]&&cgFuncEnum[k](a);var l=j.match(f);for(var m in l)if(l.hasOwnProperty(m)){var n=l[m];n&&(d=n.replace("{{","").replace("}}",""),c=getval(b,d),isNull(c)||(e[h].value=e[h].value.replace(n,c)))}}var o=g.match(f);o&&o.forEach(function(e){d=e.replace("{{","").replace("}}",""),c=getval(b,d),isNull(c)||a.html(g.replace(e,c))})},bindElement=function(a,b){a=$(a);var c=a.attr("cg-bind"),d=getval(data,c),e=a.children();if(0===e.length)replaceAttr(a,b),isNull(c)||setval(a,d);else{for(var f=e.length-1;f>=0;f--)bindElement(e[f],b);replaceAttr(a,b),isNull(c)||setval(a,d)}};bindElement(that,data)},bindList:function(a,b){var c=a.data||{},d=void 0===a.empty?!0:a.empty,e=a.templateId,f=a.length;if($.isArray(c)){var g=this,h=$($(e).html());f=f||c.length,d&&g.empty();for(var i=0,j=f;j>i;i++){var k=h.clone();if(g.append(k),$.isPlainObject(c[i]))k.bindData(c[i]);else{var l=k.find("[cg-bind=value]");l.is("input")||l.is("select")?l.is("[type=checkbox]")||l.is("[type=radio]")?l.prop("checked",c[i]):l.val(c[i]).trigger("change"):l.text(c[i])}$.isFunction(b)&&b(k,c[i])}}},cgbind:function(a,b){var c=this,d=a.data||{},e=a.templateId;if($.isArray(d)){if(!e)return;c.bindList(a,b)}else"object"==typeof d&&(e?(a.data=[d],c.bindList(a,b)):c.bindData(d))}})}(window.jQuery);